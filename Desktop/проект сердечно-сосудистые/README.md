# Heart Attack Prediction API

Данный репозиторий представляет собой проект по разработке модели машинного обучения, предназначенной для оценки вероятности возникновения сердечного приступа у пациентов. Цель проекта — создание инструмента, способного эффективно помогать медицинским специалистам выявлять риски сердечно-сосудистых патологий среди различных групп населения.

## Задачи проекта

Предполагается, что в ходе работы над проектом будут решены следующие задачи:
- Исследование датасета (предполагается поиск дополнительной информации для лучшего понимания природы данных)
- Предобработка данных. В данных могут быть бесполезные признаки, сильно скорелированные признаки а также косвенные утечки целевого признака. Некоторые колонки потребуется преобразовать к нужному типу данных.
- Обучение модели
- Подготовка предсказания на тестовой выборке. Файл предсказаний должен быть в csv формате и содержать 2 столбца: “id” и “prediction”. 
- Подготовка скриптов и библиотеки для обработки данных и предсказания на тестовой выборке
- Написание инструмента для тестирования
- Оформление документации


## О проекте

API для предсказания риска сердечного приступа на основе медицинских данных пациентов. Проект включает:
- ML модель (Random Forest) для предсказания риска
- FastAPI приложение с RESTful API
- Возможность загрузки CSV файлов для пакетного предсказания
- Автоматическую документацию Swagger и ReDoc
- Тестовый клиент для проверки API


## Технологии
- **FastAPI** - веб-фреймворк
- **Uvicorn** - ASGI сервер
- **Scikit-learn** - машинное обучение
- **Pandas** - обработка данных
- **Joblib** - сериализация модели

## Структура проекта

heart-attack-prediction/
├── app/           # Приложение FastAPI
│ ├── init.py
│ ├── main.py      # Основной файл приложения
│ ├── model.py     # Логика работы с моделью
│ ├── schemas.py   # Pydantic схемы
│ └── utils.py     # Вспомогательные функции
├── models/        # Сохраненные модели
│ └── best_model.pkl # Обученная модель
├── tests/         # Тесты
│ └── test_api.py
├── data/          # Данные (не включены в git)
│ ├── heart_train.csv
│ └── heart_test.csv
├── requirements.txt # Зависимости
├── .gitignore # Игнорируемые файлы
├── README.md 

## Запуск API

uvicorn app.main:app --reload
API будет доступно по адресу: http://127.0.0.1:8000

## Тестирование API

python test_client.py

Для удобства тестирования реализован Web-интерфейс, позволяющий получить как одно, так и множество предсказаний.
Сервер приложения запускается с помощью команды uvicorn. Полный синтаксис команды с дополнительными параметрами:

Параметры команды:

app.main:app: Указывает путь к основному приложению. Здесь app — название пакета, main — имя модуля внутри пакета, а app — экземпляр FastAPI.
--host 0.0.0.0: Позволяет серверу прослушивать запросы извне (актуально при размещении сервиса в локальной сети).
--port 8000: Определяет порт, на котором будет запущен сервер. По умолчанию используется порт 8000.
--reload: Включает режим автоматического перезапуска сервера при изменении файлов проекта. Это полезно во время разработки, так как изменения автоматически применяются без необходимости вручную перезагружать сервер.



## Документация API 

После запуска доступны:
Swagger UI: http://127.0.0.1:8000/docs
ReDoc: http://127.0.0.1:8000/redoc

## Основные эндпоинты

GET / - Информация об API

GET /health - Проверка работоспособности

GET /model/info - Информация о модели

POST /predict/csv - Предсказание по CSV файлу

POST /predict/single - Предсказание для одного пациента

##  Использование модели

Загрузка CSV файла:

curl -X POST "http://127.0.0.1:8000/predict/csv" \
  -H "accept: application/json" \
  -H "Content-Type: multipart/form-data" \
  -F "file=@data/test_data.csv"

## Предсказание для одного пациента:

import requests

data = {
    "age": 55,
    "cholesterol": 240,
    "heart_rate": 72,
    "diabetes": 1,
    "family_history": 1
}

response = requests.post("http://127.0.0.1:8000/predict/single", json=data)
print(response.json())

## Лицензия

MIT License

## Метрики модели
- Алгоритм: Random Forest
- ROC-AUC: 0.5909
- Количество признаков: 24
- Размер обучающей выборки: 8,685 пациентов

