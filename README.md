## ﻿API для прогнозирования сердечного приступа

Этот репозиторий представляет собой проект по разработке модели машинного обучения, предназначенной для оценки вероятности сердечного приступа у пациентов. Цель проекта — создание инструмента, который поможет медицинским работникам эффективно выявлять риски сердечно-сосудистых заболеваний у различных групп населения.

## Задачи проекта

Предполагается, что в ходе работы над проектом будут решены следующие задачи:

- Исследование датасета (предполагается поиск дополнительной информации для лучшего понимания природы данных)
- Предварительная обработка данных. В данных могут быть бесполезные признаки, сильно коррелирующие признаки, а также косвенные утечки целевого признака. Некоторые столбцы потребуется преобразовать в нужный тип данных.
- Обучение модели
- Подготовка прогнозов для тестовой выборки. Файл с прогнозами должен быть в формате csv и содержать 2 столбца: «id» и «prediction».
- Подготовка скриптов и библиотеки для обработки данных и прогнозирования на тестовой выборке
- Написание инструмента для тестирования
- Оформление документации

## О проекте
API для прогнозирования риска сердечного приступа на основе медицинских данных пациентов. Проект включает в себя:

- Модель машинного обучения (Random Forest) для прогнозирования рисков
- Приложение FastAPI с RESTful API
- Возможность загрузки CSV-файлов для пакетного прогнозирования
- Автоматическая документация Swagger и ReDoc
- Тестовый клиент для проверки API
  
## Технологии
- FastAPI — веб-фреймворк
- Uvicorn — сервер ASGI
- Scikit-learn — машинное обучение
- Pandas — обработка данных
- Joblib — сериализация модели
  
## Структура проекта

heart-attack-prediction/ 

 ├── app/          # Приложение FastAPI 
 
│ ├── init.py 

│├── main.py      # Основной файл приложения 

│├── model.py     # Логика работы с моделью 

 │ ├── schemas.py  # Pydantic схемы 
 
│ └── utils.py    # Вспомогательные функции 

├── models/       # Сохраненные модели 

│ └── best_model.pkl # Обученная модель 

├── tests/        # Тесты 

│ └── test_api.py 

├── data/         # Данные (не включены в git) 

│ ├── heart_train.csv 

│ └── heart_test.csv 

├── requirements.txt # Зависимости 

├── .gitignore    # Игнорируемые файлы 

├── README.md

## Запуск API
uvicorn app.main:app --reload 
API будет доступно по адресу: http://127.0.0.1:8000

## Тестирование API
python test_client.py

Для удобства тестирования реализован веб-интерфейс, позволяющий получить как одно, так и несколько предсказаний. Сервер приложения запускается с помощью команды uvicorn. Полный синтаксис команды с дополнительными параметрами:

Параметры команды:

app.main:app: указывает путь к основному приложению. Здесь app — название пакета, main — имя модуля внутри пакета, а app — экземпляр FastAPI. --host 0.0.0.0: позволяет серверу прослушивать запросы извне (актуально при размещении сервиса в локальной сети). --port 8000: определяет порт, на котором будет запущен сервер. По умолчанию используется порт 8000. --reload: включает режим автоматического перезапуска сервера при изменении файлов проекта. Это удобно во время разработки, так как изменения применяются автоматически, без необходимости перезагружать сервер вручную.

## Документация API

После запуска доступны: 

пользовательский интерфейс Swagger: http://127.0.0.1:8000/docs 

ReDoc: http://127.0.0.1:8000/redoc

## Основные эндпоинты

GET / — информация об API

GET /health — проверка работоспособности

GET /model/info — информация о модели

POST /predict/csv — прогнозирование по CSV-файлу

POST /predict/single — прогнозирование для одного пациента

## Использование модели
Загрузка CSV-файла:

curl -X POST "http://127.0.0.1:8000/predict/csv"
-H "accept: application/json"
-H "Content-Type: multipart/form-data"
-F "file=@data/test_data.csv"

Прогноз для одного пациента:
import requests

data = { "возраст": 55, "уровень холестерина": 240, "частота сердечных сокращений": 72, "диабет": 1, "семейная история": 1 }

response = requests.post("http://127.0.0.1:8000/predict/single", json=data) print(response.json())

## Лицензия
MIT License

## Метрики модели
Алгоритм: случайный лес

ROC-AUC: 0,5909

Количество признаков: 24

Размер обучающей выборки: 8685 пациентов


